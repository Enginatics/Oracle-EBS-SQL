# Case Study & Technical Analysis: AP Open Balances Revaluation

## 1. Executive Summary

### Business Problem
Multinational organizations frequently transact in foreign currencies. As exchange rates fluctuate, the value of open liabilities (unpaid invoices) changes relative to the functional currency. For accurate financial reporting (ASC 830 / IAS 21), companies must "revalue" these open balances at month-end to reflect the spot rate, booking the difference as an unrealized gain or loss. Failure to do so results in misstated liabilities and inaccurate P&L.

### Solution Overview
The **AP Open Balances Revaluation** report (and its modern counterpart, **AP Open Items Revaluation**) calculates the revalued amount of all open foreign currency invoices as of a specific period end. It compares the original accounted amount (at the transaction date rate) with the revalued amount (at the period-end rate) to derive the unrealized gain/loss. This report serves as the supporting schedule for the General Ledger revaluation journal.

### Key Benefits
*   **Compliance:** Ensures adherence to multi-currency accounting standards.
*   **Accuracy:** Provides a detailed audit trail for the "Unrealized Gain/Loss" account in the GL.
*   **Visibility:** Highlights exposure to specific volatile currencies.

## 2. Technical Analysis

### Core Tables and Views
This report relies on a mix of transactional tables and Subledger Accounting (SLA) data:
*   **`AP_INVOICES_ALL`**: The source of the liability.
*   **`AP_INVOICE_PAYMENTS_ALL`**: Used to determine how much of the invoice remains open.
*   **`AP_OPEN_ITEMS_REVAL_GT`**: A Global Temporary table populated by the standard Oracle Revaluation program. This table stores the snapshot of open items and their calculated revaluation amounts.
*   **`XLA_AE_HEADERS` / `XLA_AE_LINES`**: Links the AP transaction to its underlying accounting entries.

### SQL Logic and Data Flow
The report is unique because it often relies on the data generated by the standard Oracle "Open Items Revaluation" concurrent program.
*   **Data Generation:** When the standard program runs, it populates the `AP_OPEN_ITEMS_REVAL_GT` table.
*   **Reporting:** The SQL query extracts data from this temporary table, joining it back to `AP_INVOICES_ALL` and `PO_VENDORS` to add master data context (Supplier Name, Invoice Number) that might be missing or summarized in the temp table.
*   **Calculation:** `(Open Foreign Amount * End-of-Period Rate) - (Open Functional Amount)` = `Unrealized Gain/Loss`.

### Integration Points
*   **General Ledger:** The output must match the revaluation journal created in GL.
*   **Daily Rates:** Relies on the `GL_DAILY_RATES` table for the period-end spot rates.

## 3. Functional Capabilities

### Parameters & Filtering
*   **Revaluation Period:** The target period for the revaluation (determines the rate date).
*   **Rate Type:** Usually 'Spot' or 'Corporate'.
*   **Transferred to GL only:** Filters for transactions that have already been accounted and posted, ensuring the revaluation is based on final numbers.
*   **Cleared Only:** Option to include/exclude reconciled payments.

### Performance & Optimization
*   **Temporary Table Usage:** By leveraging the `GT` table, the report avoids recalculating complex remaining balances from scratch, relying instead on Oracle's standard logic.

## 4. FAQ

**Q: Why is this report marked as "Legacy"?**
A: Oracle has transitioned to the "Open Items Revaluation" architecture. While this report format is still used by some for its specific layout, the underlying data source is the same.

**Q: Why don't I see my invoice?**
A: Ensure the invoice was open (unpaid) as of the "Revaluation Period" end date and that it is in a foreign currency. Functional currency invoices do not require revaluation.
