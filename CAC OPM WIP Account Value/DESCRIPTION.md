# Case Study & Technical Analysis: CAC OPM WIP Account Value

## Executive Summary
The **CAC OPM WIP Account Value** report provides the Work in Process (WIP) valuation for OPM Batches. Unlike Discrete WIP (which is a snapshot of the job balance), OPM WIP is often derived from the cumulative accounting entries generated by the Subledger Accounting (SLA) engine. This report summarizes those entries to provide a batch-level WIP balance.

## Business Challenge
*   **WIP Visibility**: In OPM, "WIP" is a fluid concept. Materials are issued, products are yielded, and the difference sits in WIP until the batch closes.
*   **Reconciliation**: Reconciling the WIP GL account to the specific batches is notoriously difficult in OPM.
*   **Month-End**: Finance needs to know the value of open batches to validate the balance sheet.

## Solution
This report queries the SLA data.
*   **Source**: `xla_ae_lines` (The accounting entries).
*   **Aggregation**: Sums Debits and Credits by Batch ID.
*   **Status**: Shows whether the batch is Open, Closed, or Cancelled.

## Technical Architecture
*   **Tables**: `gme_batch_header`, `xla_ae_headers`, `xla_ae_lines`.
*   **Logic**: It looks for accounting entries associated with the "Production" event class in OPM.
*   **Prerequisite**: "Create Accounting" must be run for the period to populate the data.

## Parameters
*   **Period Name**: (Mandatory) Accounting Period.
*   **Include Lab Batches**: (Optional) To include R&D batches.
*   **Show Transaction Details**: (Optional) To see the individual entries vs. the batch summary.

## Performance
*   **Heavy**: Querying XLA tables is resource-intensive. The report aggregates millions of rows.

## FAQ
**Q: Why is the WIP value negative?**
A: In OPM, if you yield the product *before* you issue the ingredients (backflushing timing issues), the WIP balance can temporarily go negative.

**Q: Does it match the GL?**
A: Yes, because it queries the *exact same table* (XLA) that posts to the GL.
